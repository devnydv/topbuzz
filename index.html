<!DOCTYPE html>
<html lang="en">

<head>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MMN4WWQJ9G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-MMN4WWQJ9G');
  </script>
  <!-- Google tag (gtag.js) -->


  <meta content='index,follow' name='robots' />
  <meta content='Dev Nararan Yadav' name='author' />
  <meta content='all' name='robots' />
  <meta content='en' name='language' />
  <meta content='IN' name='country' />

  <meta property="og:locale" content="en_In">
  <meta property="og:type" content="article">


  <meta name='Keywords' content='Best Deals on Top Mobile Brands, Deals, flipkart deals, all flipkart product, online deals, deals on mobiles, deals on earphones, laptops, Gaming_Laptops, DSLR, Printers, Inks, Back_Cases' />

  <meta http-equiv='content-language' content='en-in'>
  <link rel="shortcut icon" href="icons/icon.webp" type="image/x-icon">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Top selected items for the users to buy online. These are selected according to there specifications and user experiences.">
  <link rel="stylesheet" href="css/test.css">
  <title>Deals: Find best deals and offers</title>
</head>

<body>

  <nav id="hemu">
    <div id="logo">


      <img id="mnicon" src="icons/menu_black_24dp.svg" alt="" onclick="notvisi()">
      <a href="/" title="TopTechBuzz">
        <p>Deals</p>
      </a>
    </div>
    <div id="menug">
      <ul id="ul" class="notvisi">
        <a href="/" title="toptechbuzz">
          <li>Home</li>
        </a>
        <a href="https://lowoncost.xyz" title=" Filtered Deals">
          <li>Lowoncost</li>
        </a>
        <a href="https://product.lowoncost.xyz" title="product from amazon">
          <li>Amazon Deals</li>
        </a>
        <!--   <a href="news.html" title="technews">
          <li>News</li>
        </a> -->

        <!-- <a href="review.html" title="Review">
          <li>Review</li>
        </a> -->

      </ul>
    </div>
  </nav>

  <div id="smain">

    <div id='titl'>

      <div class="about">


      </div>
    </div>






    <div id="main">
      <div id="loading" style="font-size: 80px">
        <div class="ndiv">
‚è≥
        </div>
      </div>


    </div>

  </div>




  <div id="footer">
    <div class="elem">
      <h4>Deals.lowoncost</h4>
      <p>Deals.lowoncost.xyz is subsidiary website of lowoncost. The site aims to find out popular products from flipkart and list them at one place. </p>
    </div>
    <div class="elem">
      <h4>Deals</h4>
      <a href="?title=smartphone" title="smartphone">
        <p>Smartphones</p>
      </a>
      <a href="?title=Air_Conditioners" title="air conditioners">
        <P>Air Conditioners</P>
      </a>
      <a href="?title=Refrigerators" title="Refrigerators">
        <P>Refrigerators</P>
      </a>
      <a href="?title=Kitchen_Appliances" title="Kitchen_Appliances">
        <p>Kitchen Appliances</p>
      </a>
    </div>
    <div class="elem">
      <h4> Follow and contact</h4>

      <a href="https://www.facebook.com/Lowoncost/" title="facebook page">
        <p>Facebook</p>
      </a>
      <!--       <a href=""><p>Privacy</p></a> -->
      <!-- <a href=""><p>Instagram</p></a> -->
    </div>
    <div class="elem">
      <h4>More</h4>
      <a href="https://lowoncost.xyz" title="Lowoncost">
        <p>Deals and offers</p>
      </a>

    </div>
  </div>

</body>
<script>
  //........................code for menu bar..........................
  async function mdata() {
    let menudata = await fetch("data/data.json")
    let gotmdata = await menudata.json();
    //console.log(gotmdata);
    let nobj = Object.keys(gotmdata.id1)
    //console.log(nobj.length);
    let about = document.getElementsByClassName("about");
    let paara = "<p>lets do it</p>"







    for (let i = 0; i < nobj.length; i++) {
      let cattitle = `<h3>${nobj[i]}</h3>`;
      about[0].insertAdjacentHTML('beforeend', cattitle)



      let lgtinner = Object.keys(gotmdata.id1[nobj[i]])
      //console.log(lgtinner.length)
      for (let j = 0; j < lgtinner.length; j++) {
        let valinner = lgtinner[j]

        let gettitle = gotmdata.id1[nobj[i]][valinner].title;
        let c = gettitle.split(" ").join('+');

        let link = `<a href=?title=${c}>
          <p>${gotmdata.id1[nobj[i]][valinner].title}</p>
            </a>`
        about[0].insertAdjacentHTML('beforeend', link)
        //console.log(link);
      }

    }
  }
  mdata();









  //menubar ends here......................................................


  let url = new URLSearchParams(window.location.search);
  //console.log(window.location.pathname);
  let title = url.get('title');
  if (title == null) {
    title = "Kitchen+deals";






    // let htitle=`<title>Top Tranding ${title}</title>`
    // console.log(htitle);
    // document.head.insertAdjacentHTML("beforeend",htitle);
  }

  let c = title.split("+").join(' ');
  console.log(c);

  //.................Meta....title....seo......................
  document.title = "Deals: Top Best Tranding " + c;

  //   let meta= `<meta content='TopTechBuzz.xyz :: Top Tranding ${ c}  ' property='og:title' />
  //   <meta name="description" property='og: description'
  //     content="Top selected ${ c} for the users to buy online. These are selected according to there specifications and user experiences.">

  //     `
  //   document.head.insertAdjacentHTML("beforeend",meta);

  let meta = document.querySelector('meta[name="description"]');
  meta.setAttribute("content", `Top selected ${c} for the users to buy online. These are selected according to there specifications and user experiences.`);



  let main = document.getElementById('main');
  let div = document.createElement("div");
  let h1 = document.createElement('h1');
  div.setAttribute("id", 'head')
  h1.innerText = "Top Tranding " + c;
  div.appendChild(h1)
  main.appendChild(div);




  let fetchurl = "https://flipkart.dvishal485.workers.dev/search/" + title + "&sort=popular"

  //save data locally
  if (localStorage.getItem(c) == null) {
    console.log('data not found');


    fetch(fetchurl)
      .then(res => res.json())
      .then(data => {
        data = data.result
        console.log(data)
        localStorage.setItem(c, JSON.stringify(data));
        getdata()
      });
  } else {
    console.log('lol')
    getdata()
  }


  let expirationTime = 6000 * 10
  setTimeout(function() {
    localStorage.removeItem(c);
  }, expirationTime);



  getdata()

  function getdata() {
    let data = JSON.parse(localStorage.getItem(c));
    //let res = await fetch
    //let data = await res.json()
    //data= data.result
    for (let i = 0; i <= 14; i++) {
      console.log(data[i])

      let main = document.getElementById('main');

      let ndiv = document.createElement("div");
      let dimg = document.createElement("div");
      let dtls = document.createElement('div');
      let img = document.createElement('img');
      let para = document.createElement('h2');
      let prc = document.createElement('p');
      let oprc = document.createElement('p');
      let rat = document.createElement('p');
      let but = document.createElement('button');
      let but1 = document.createElement('button');
      let h2 = document.createElement('h3');
      let link = document.createElement("a");
      let link1 = document.createElement('a');

      ndiv.setAttribute('class', 'ndiv');
      dimg.setAttribute('class', 'img');
      if (data[i].thumbnail === undefined) {
        console.log('not')
      } else {
        img.setAttribute("src", data[i].thumbnail);
      }

      img.setAttribute("alt", data.name);
      img.setAttribute("loading", "lazy");
      dtls.setAttribute('class', 'details');
      prc.setAttribute('class', 'price');
      oprc.setAttribute('class', 'mrp');
      rat.setAttribute('class', 'rat');
      //console.log(data1.share_url)
      link.setAttribute('href', data[i].link);
      link.setAttribute("target", "blank_")

      let nppara = data[i].link
      let rep = nppara.replace("https://www.flipkart.com/", "")
      let rep1 = rep.replace("https://dl.flipkart.com/dl/", "")
      let c = rep1.split("/").join('_');
      //console.log(c);
      link1.setAttribute('href', "details.html?title=" + c);
      link1.setAttribute('title', "Details of " + data[i].name);
      // link1.setAttribute("target", "blank_")
      para.innerText = data[i].name;
      prc.innerText = "Price: " + data[i].current_price;
      oprc.innerText = "MRP: " + data[i].original_price;
      rat.innerText = data[i].rating;
      but.innerText = "Buy Now";
      but1.innerText = "View Full Details";
      but.setAttribute('class', 'but');
      but1.setAttribute('class', 'but');
      //  h2.innerText = "Highlights:";








      dtls.appendChild(para);
      dtls.appendChild(prc);
      dtls.appendChild(oprc);
      //dtls.appendChild(rat);
      link.appendChild(but);
      link1.appendChild(but1);
      dtls.appendChild(link);
      dtls.appendChild(link1);
      //dtls.appendChild(h2);
      dimg.appendChild(img);
      ndiv.appendChild(dimg);
      ndiv.appendChild(dtls);
      main.appendChild(ndiv);

    }
    let loadname = document.getElementById("loading");
    loadname.remove();
  }
</script>
<script>
  function notvisi() {

    let btn = document.getElementById('ul');
    btn.classList.toggle('notvisi');

  }
</script>


</html>
